# ë©”ì‹ ì € ë´‡ ì„¤ì • ê°€ì´ë“œ - ê°„í—ì  ì˜¤ë¥˜ í•´ê²°

## ë¬¸ì œ í˜„ìƒ
- ì–´ë–¤ ëª…ë ¹ì–´ëŠ” ë°”ë¡œ ì‘ë‹µì´ ì˜¤ê³ , ì–´ë–¤ ê²ƒì€ ì‘ë‹µì´ ì•ˆ ì˜´
- íŠ¹íˆ ì˜í™” ìˆœìœ„ ê°™ì€ ë³µì¡í•œ ëª…ë ¹ì–´ì—ì„œ ìì£¼ ë°œìƒ

## ì›ì¸ ë¶„ì„

### 1. **íƒ€ì„ì•„ì›ƒ ë¬¸ì œ (ê°€ì¥ í”í•¨)**
```
[ì¼ë°˜ ëª…ë ¹ì–´] 0.1ì´ˆ â†’ âœ… ì„±ê³µ
[ì˜í™” ìˆœìœ„] 3-5ì´ˆ â†’ âŒ íƒ€ì„ì•„ì›ƒ
```

### 2. **ë©”ì‹œì§€ í¬ê¸°/íŠ¹ìˆ˜ë¬¸ì ë¬¸ì œ**
- ì´ëª¨ì§€ê°€ ë§ì€ ë©”ì‹œì§€ (ğŸ¥‡ğŸ¥ˆğŸ¥‰ ë“±)
- 1000ì ì´ìƒì˜ ê¸´ ë©”ì‹œì§€
- íŠ¹ìˆ˜ ìœ ë‹ˆì½”ë“œ ë¬¸ì

### 3. **ì¤‘ë³µ ìš”ì²­ ë¬¸ì œ**
- ë©”ì‹ ì € ë´‡ì´ ì‘ë‹µì„ ëª» ë°›ìœ¼ë©´ ìë™ ì¬ì‹œë„
- ì„œë²„ì— ë¶€í•˜ ì¦ê°€ â†’ ë” ëŠë ¤ì§

## í•´ê²° ë°©ë²•

### ë°©ë²• 1: ë©”ì‹ ì € ë´‡ íƒ€ì„ì•„ì›ƒ ì„¤ì • ë³€ê²½

ë©”ì‹ ì € ë´‡ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ:

```javascript
// ê¸°ì¡´ ì½”ë“œ
var result = Api.callApi({
    url: "https://YOUR_URL.ngrok.io/api/kakaotalk",
    method: "POST",
    data: { room: room, sender: sender, msg: msg }
});

// ê°œì„ ëœ ì½”ë“œ (íƒ€ì„ì•„ì›ƒ 10ì´ˆ)
var result = Api.callApi({
    url: "https://YOUR_URL.ngrok.io/api/kakaotalk",
    method: "POST",
    data: { room: room, sender: sender, msg: msg },
    timeout: 10000  // 10ì´ˆ íƒ€ì„ì•„ì›ƒ
});
```

### ë°©ë²• 2: ê°œì„ ëœ ì„œë²„ ì‚¬ìš©

```bash
# ê¸°ì¡´ ì„œë²„ ì¢…ë£Œ
Ctrl + C

# ê°œì„ ëœ ì„œë²„ ì‹¤í–‰
python main_improved.py
```

ê°œì„  ì‚¬í•­:
- 4ì´ˆ íƒ€ì„ì•„ì›ƒ ìë™ ì²˜ë¦¬
- ì‘ë‹µ ìºì‹œ (ì¤‘ë³µ ìš”ì²­ ë°©ì§€)
- ë©”ì‹œì§€ ìë™ ì •ë¦¬ (1000ì ì œí•œ, ì´ëª¨ì§€ ë³€í™˜)

### ë°©ë²• 3: ë¹ ë¥¸ ì˜í™” ìˆœìœ„ ì‚¬ìš©

fn.pyë¥¼ ìˆ˜ì •:

```python
# fn.py ìƒë‹¨ì— ì¶”ê°€
from fn_optimized import movie_rank_fast

# movie_rank í•¨ìˆ˜ë¥¼ ëŒ€ì²´
def movie_rank(room: str, sender: str, msg: str):
    """ë¹ ë¥¸ ì˜í™” ìˆœìœ„"""
    return movie_rank_fast(room, sender, msg)
```

### ë°©ë²• 4: ë©”ì‹ ì € ë´‡ ì‘ë‹µ ì²˜ë¦¬ ê°œì„ 

```javascript
function response(room, msg, sender, isGroupChat, replier) {
    try {
        // ì˜í™” ìˆœìœ„ëŠ” ì¦‰ì‹œ ì•Œë¦¼
        if (msg.includes("/ì˜í™”ìˆœìœ„")) {
            replier.reply("ğŸ¬ ì˜í™” ìˆœìœ„ ì¡°íšŒ ì¤‘...");
        }
        
        // API í˜¸ì¶œ (ì¬ì‹œë„ ë¡œì§ í¬í•¨)
        var result = null;
        var retryCount = 0;
        
        while (retryCount < 2 && !result) {
            result = Api.callApi({
                url: "https://YOUR_URL.ngrok.io/api/kakaotalk",
                method: "POST",
                data: { 
                    room: room, 
                    sender: sender, 
                    msg: msg 
                },
                timeout: 8000  // 8ì´ˆ
            });
            
            if (!result || !result.is_reply) {
                retryCount++;
                java.lang.Thread.sleep(1000);  // 1ì´ˆ ëŒ€ê¸°
            }
        }
        
        // ì‘ë‹µ ì²˜ë¦¬
        if (result && result.is_reply) {
            // ê¸´ ë©”ì‹œì§€ ë¶„í•  ì „ì†¡
            var replyMsg = result.reply_msg;
            if (replyMsg.length > 500) {
                var parts = replyMsg.match(/.{1,500}/g);
                for (var i = 0; i < parts.length; i++) {
                    replier.reply(parts[i]);
                    if (i < parts.length - 1) {
                        java.lang.Thread.sleep(500);
                    }
                }
            } else {
                replier.reply(replyMsg);
            }
        }
    } catch(e) {
        // ì˜¤ë¥˜ ë¬´ì‹œ (ì¡°ìš©íˆ ì‹¤íŒ¨)
    }
}
```

## ì¦‰ì‹œ ì ìš© ê°€ëŠ¥í•œ í•´ê²°ì±…

### 1ë‹¨ê³„: ì„œë²„ ì¬ì‹œì‘
```bash
# ê°œì„ ëœ ì„œë²„ë¡œ êµì²´
python main_improved.py
```

### 2ë‹¨ê³„: ë©”ì‹ ì € ë´‡ íƒ€ì„ì•„ì›ƒ ëŠ˜ë¦¬ê¸°
- ë©”ì‹ ì € ë´‡ ì•±ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì •
- timeout: 10000 ì¶”ê°€

### 3ë‹¨ê³„: í…ŒìŠ¤íŠ¸
```
/ëª…ë ¹ì–´  â†’ ë¹ ë¥¸ ì‘ë‹µ í™•ì¸
/ì˜í™”ìˆœìœ„ â†’ ëŠë¦° ì‘ë‹µë„ ì˜¤ëŠ”ì§€ í™•ì¸
```

## ë””ë²„ê¹… ëª…ë ¹ì–´

ì„œë²„ ì½˜ì†”ì—ì„œ í™•ì¸í•  ë‚´ìš©:

```
[ì˜í™”ìˆœìœ„] ë„¤ì´ë²„ ì˜í™” ì‹œë„...  # ë¹ ë¥¸ ë°©ë²•
[ì˜í™”ìˆœìœ„] ë„¤ì´ë²„ ì„±ê³µ         # 1ì´ˆ ì´ë‚´
[ì˜í™”ìˆœìœ„] ìºì‹œ ì‚¬ìš© (5.2ë¶„ ê²½ê³¼)  # ìºì‹œ í™œìš©

ë˜ëŠ”

[ì˜í™”ìˆœìœ„] Selenium ì‹œë„ ì¤‘...  # ëŠë¦° ë°©ë²•  
[ì˜í™”ìˆœìœ„] Selenium ì„±ê³µ       # 3-5ì´ˆ
íƒ€ì„ì•„ì›ƒ: /ì˜í™”ìˆœìœ„            # 4ì´ˆ ì´ˆê³¼ì‹œ
```

## ì˜êµ¬ í•´ê²° ë°©ë²•

### ì˜µì…˜ 1: ì •ì  ìŠ¤í¬ë˜í•‘ë§Œ ì‚¬ìš©
- ë¹ ë¥´ì§€ë§Œ ë°ì´í„°ê°€ ì œí•œì 
- fn_optimized.py ì‚¬ìš©

### ì˜µì…˜ 2: ë°±ê·¸ë¼ìš´ë“œ ì—…ë°ì´íŠ¸
- 30ë¶„ë§ˆë‹¤ ìë™ìœ¼ë¡œ ì˜í™” ìˆœìœ„ ì—…ë°ì´íŠ¸
- ì‚¬ìš©ì ìš”ì²­ì‹œ ìºì‹œëœ ë°ì´í„° ì¦‰ì‹œ ì „ì†¡

### ì˜µì…˜ 3: ë¹„ë™ê¸° ì‘ë‹µ
- "ì¡°íšŒ ì¤‘..." ë©”ì‹œì§€ ë¨¼ì € ì „ì†¡
- ë°ì´í„° ì¤€ë¹„ë˜ë©´ ì¶”ê°€ ì „ì†¡

## ì²´í¬ë¦¬ìŠ¤íŠ¸

âœ… ë©”ì‹ ì € ë´‡ íƒ€ì„ì•„ì›ƒ 10ì´ˆë¡œ ì„¤ì •
âœ… ì„œë²„ ê°œì„  ë²„ì „ ì‚¬ìš© (main_improved.py)
âœ… ë„¤ì´ë²„/CGV ë°±ì—… ìŠ¤í¬ë˜í•‘ í™œì„±í™”
âœ… ì‘ë‹µ ìºì‹œ ì‹œìŠ¤í…œ ì‘ë™
âœ… ë©”ì‹œì§€ 1000ì ì œí•œ
âœ… ì´ëª¨ì§€ ìë™ ë³€í™˜

## ë¬¸ì œ ì§€ì†ì‹œ

1. ngrok ë¡œê·¸ í™•ì¸: http://127.0.0.1:4040
2. ì„œë²„ ë¡œê·¸ì—ì„œ "íƒ€ì„ì•„ì›ƒ" ê²€ìƒ‰
3. ë©”ì‹ ì € ë´‡ ë¡œê·¸ í™•ì¸
4. ë„¤íŠ¸ì›Œí¬ ìƒíƒœ ì ê²€